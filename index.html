<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UMKM Product Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/_sdk/element_sdk.js"></script>
    <style>
      body {
        box-sizing: border-box;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
      }

      .page {
        display: none;
        animation: fadeIn 0.3s ease-in;
      }

      .page.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .product-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
      }

      .product-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .theme-toggle {
        transition: all 0.3s ease;
      }

      /* Light theme */
      body.light {
        background-color: #ffffff;
        color: #1f2937;
      }

      body.light .nav-bar {
        background-color: #ffffff;
        border-bottom: 1px solid #e5e7eb;
      }

      body.light .card-bg {
        background-color: #f9fafb;
      }

      body.light .text-primary {
        color: #1f2937;
      }

      body.light .text-secondary {
        color: #6b7280;
      }

      body.light .border-color {
        border-color: #e5e7eb;
      }

      /* Dark theme */
      body.dark {
        background-color: #111827;
        color: #f9fafb;
      }

      body.dark .nav-bar {
        background-color: #1f2937;
        border-bottom: 1px solid #374151;
      }

      body.dark .card-bg {
        background-color: #1f2937;
      }

      body.dark .text-primary {
        color: #f9fafb;
      }

      body.dark .text-secondary {
        color: #9ca3af;
      }

      body.dark .border-color {
        border-color: #374151;
      }

      .btn-primary {
        background-color: #10b981;
        color: white;
        transition: all 0.3s ease;
      }

      .btn-primary:hover {
        background-color: #059669;
        transform: translateY(-2px);
      }

      .admin-panel {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 100;
      }

      .admin-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 999;
        overflow-y: auto;
      }

      .admin-modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
    <style>
      @view-transition {
        navigation: auto;
      }
    </style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  </head>
  <body class="light">
    <!-- Navigation Bar -->
    <nav class="nav-bar fixed top-0 w-full z-50 shadow-sm">
      <div class="container mx-auto px-6 py-4">
        <div class="flex justify-between items-center">
          <h1
            id="nav-store-name"
            class="text-2xl font-bold text-primary cursor-pointer"
            onclick="navigateTo('home')"
          >
            TokoKu
          </h1>
          <div class="flex items-center gap-6">
            <a
              onclick="navigateTo('home')"
              class="text-sm font-medium text-secondary hover:text-primary cursor-pointer"
              >Beranda</a
            >
            <a
              onclick="navigateTo('products')"
              class="text-sm font-medium text-secondary hover:text-primary cursor-pointer"
              >Produk</a
            >
            <a
              onclick="navigateTo('contact')"
              class="text-sm font-medium text-secondary hover:text-primary cursor-pointer"
              >Kontak</a
            >
            <a
              onclick="navigateTo('testimonials')"
              class="text-sm font-medium text-secondary hover:text-primary cursor-pointer"
              >Testimoni</a
            >
            <button
              onclick="toggleTheme()"
              class="theme-toggle px-4 py-2 rounded-lg text-sm font-medium card-bg"
            >
              <span id="theme-icon">üåô</span>
            </button>
          </div>
        </div>
      </div>
    </nav>
    <!-- Home Page -->
    <div id="home" class="page active" style="padding-top: 80px">
      <!-- Banner Promo -->
      <section class="card-bg py-20">
        <div class="container mx-auto px-6 text-center">
          <div
            class="inline-block px-4 py-2 bg-red-500 text-white rounded-full text-sm font-bold mb-4"
          >
            PROMO SPESIAL
          </div>
          <h2
            id="promo-banner-text"
            class="text-5xl font-bold text-primary mb-4"
          >
            Diskon 50% Untuk Semua Produk!
          </h2>
          <p class="text-xl text-secondary mb-8">
            Buruan order sebelum kehabisan stok
          </p>
          <button
            onclick="navigateTo('products')"
            class="btn-primary px-8 py-4 rounded-lg font-bold text-lg"
          >
            Lihat Produk
          </button>
        </div>
      </section>
      <!-- Featured Products -->
      <section class="py-16">
        <div class="container mx-auto px-6">
          <h2 class="text-3xl font-bold text-primary mb-8 text-center">
            Produk Unggulan
          </h2>
          <div
            class="grid grid-cols-1 md:grid-cols-3 gap-8"
            id="featured-products"
          >
            <!-- Products will be loaded here -->
          </div>
          <div class="text-center mt-10">
            <button
              onclick="navigateTo('products')"
              class="btn-primary px-6 py-3 rounded-lg font-semibold"
            >
              Lihat Semua Produk
            </button>
          </div>
        </div>
      </section>
    </div>
    <!-- Products Page -->
    <div id="products" class="page" style="padding-top: 80px">
      <section class="py-16">
        <div class="container mx-auto px-6">
          <h2 class="text-4xl font-bold text-primary mb-10 text-center">
            Semua Produk
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-6" id="all-products">
            <!-- Products will be loaded here -->
          </div>
        </div>
      </section>
    </div>
    <!-- Product Detail Page -->
    <div id="product-detail" class="page" style="padding-top: 80px">
      <section class="py-16">
        <div class="container mx-auto px-6">
          <button
            onclick="navigateBack()"
            class="text-secondary hover:text-primary mb-6 flex items-center gap-2"
          >
            <span>‚Üê</span> Kembali
          </button>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
            <div>
              <div
                id="detail-image"
                class="card-bg rounded-2xl flex items-center justify-center"
                style="height: 500px"
              >
                <span class="text-8xl">üì¶</span>
              </div>
            </div>
            <div>
              <h1 id="detail-name" class="text-4xl font-bold text-primary mb-4">
                Nama Produk
              </h1>
              <div
                id="detail-price"
                class="text-3xl font-bold text-green-600 mb-6"
              >
                Rp 100.000
              </div>
              <div class="mb-8">
                <h3 class="text-lg font-semibold text-primary mb-3">
                  Deskripsi Produk
                </h3>
                <p
                  id="detail-description"
                  class="text-secondary leading-relaxed"
                >
                  Deskripsi lengkap produk akan muncul di sini.
                </p>
              </div>
              <button
                onclick="orderViaWhatsApp()"
                class="btn-primary w-full py-4 rounded-lg font-bold text-lg flex items-center justify-center gap-3"
              >
                <span>üí¨</span> Pesan via WhatsApp
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- Contact Page -->
    <div id="contact" class="page" style="padding-top: 80px">
      <section class="py-16">
        <div class="container mx-auto px-6 max-w-4xl">
          <h2 class="text-4xl font-bold text-primary mb-10 text-center">
            Hubungi Kami
          </h2>
          <div class="card-bg rounded-2xl p-8 mb-10">
            <h3 class="text-2xl font-bold text-primary mb-6">Profil Toko</h3>
            <div class="space-y-4">
              <div>
                <label class="text-sm font-semibold text-secondary"
                  >Nama Toko</label
                >
                <p id="contact-store-name" class="text-lg text-primary">
                  TokoKu
                </p>
              </div>
              <div>
                <label class="text-sm font-semibold text-secondary"
                  >Deskripsi</label
                >
                <p id="contact-description" class="text-lg text-primary">
                  Toko online terpercaya menyediakan berbagai produk berkualitas
                  dengan harga terjangkau.
                </p>
              </div>
              <div>
                <label class="text-sm font-semibold text-secondary"
                  >Lokasi</label
                >
                <p id="contact-location" class="text-lg text-primary">
                  Jakarta, Indonesia
                </p>
              </div>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <a
              id="whatsapp-link"
              href="#"
              target="_blank"
              rel="noopener noreferrer"
              class="card-bg rounded-xl p-6 text-center hover:shadow-lg transition-shadow"
            >
              <div class="text-5xl mb-3">üí¨</div>
              <div class="font-bold text-primary mb-2">WhatsApp</div>
              <div id="display-whatsapp" class="text-sm text-secondary">
                +62 812-3456-789
              </div></a
            >
            <a
              id="instagram-link"
              href="#"
              target="_blank"
              rel="noopener noreferrer"
              class="card-bg rounded-xl p-6 text-center hover:shadow-lg transition-shadow"
            >
              <div class="text-5xl mb-3">üì∏</div>
              <div class="font-bold text-primary mb-2">Instagram</div>
              <div id="display-instagram" class="text-sm text-secondary">
                @tokoku
              </div></a
            >
            <a
              id="facebook-link"
              href="#"
              target="_blank"
              rel="noopener noreferrer"
              class="card-bg rounded-xl p-6 text-center hover:shadow-lg transition-shadow"
            >
              <div class="text-5xl mb-3">üë•</div>
              <div class="font-bold text-primary mb-2">Facebook</div>
              <div id="display-facebook" class="text-sm text-secondary">
                TokoKu Official
              </div></a
            >
          </div>
        </div>
      </section>
    </div>
    <!-- Testimonials Page -->
    <div id="testimonials" class="page" style="padding-top: 80px">
      <section class="py-16">
        <div class="container mx-auto px-6 max-w-5xl">
          <h2 class="text-4xl font-bold text-primary mb-10 text-center">
            Testimoni Pelanggan
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="card-bg rounded-xl p-8">
              <div class="flex items-center mb-4">
                <div
                  class="w-14 h-14 bg-green-100 rounded-full flex items-center justify-center text-2xl mr-4"
                >
                  üë§
                </div>
                <div>
                  <div class="font-bold text-primary">Siti Aminah</div>
                  <div class="text-sm text-secondary">Jakarta</div>
                </div>
              </div>
              <p class="text-secondary leading-relaxed mb-4">
                "Produknya bagus banget! Pengiriman cepat dan packingnya rapi.
                Puas banget belanja di sini."
              </p>
              <div class="text-yellow-500">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>
            <div class="card-bg rounded-xl p-8">
              <div class="flex items-center mb-4">
                <div
                  class="w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center text-2xl mr-4"
                >
                  üë§
                </div>
                <div>
                  <div class="font-bold text-primary">Budi Santoso</div>
                  <div class="text-sm text-secondary">Bandung</div>
                </div>
              </div>
              <p class="text-secondary leading-relaxed mb-4">
                "Harga terjangkau, kualitas oke. Udah langganan beberapa kali,
                selalu puas. Recommended!"
              </p>
              <div class="text-yellow-500">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>
            <div class="card-bg rounded-xl p-8">
              <div class="flex items-center mb-4">
                <div
                  class="w-14 h-14 bg-purple-100 rounded-full flex items-center justify-center text-2xl mr-4"
                >
                  üë§
                </div>
                <div>
                  <div class="font-bold text-primary">Dewi Lestari</div>
                  <div class="text-sm text-secondary">Surabaya</div>
                </div>
              </div>
              <p class="text-secondary leading-relaxed mb-4">
                "Pelayanannya ramah, respon cepat. Produknya sesuai deskripsi.
                Top markotop deh!"
              </p>
              <div class="text-yellow-500">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <!-- Admin Panel Button -->
    <div class="admin-panel">
      <button
        onclick="toggleAdminModal()"
        class="bg-blue-600 text-white px-6 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700 transition-all"
      >
        ‚öôÔ∏è Admin
      </button>
    </div>
    <!-- Admin Modal -->
    <div id="admin-modal" class="admin-modal">
      <div class="card-bg rounded-2xl p-8 m-6 max-w-2xl w-full">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-primary">Panel Admin</h2>
          <button
            onclick="toggleAdminModal()"
            class="text-2xl text-secondary hover:text-primary"
          >
            √ó
          </button>
        </div>
        <form id="admin-form" class="space-y-4">
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Nama Toko</label
            >
            <input
              type="text"
              id="admin-store-name"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="TokoKu"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Nomor WhatsApp (format: 628123456789)</label
            >
            <input
              type="text"
              id="admin-whatsapp"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="628123456789"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Teks Promo Banner</label
            >
            <input
              type="text"
              id="admin-promo"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="Diskon 50% Untuk Semua Produk!"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Deskripsi Toko</label
            >
            <textarea
              id="admin-description"
              rows="3"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
            >
Toko online terpercaya menyediakan berbagai produk berkualitas dengan harga terjangkau.</textarea
            >
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Lokasi Toko</label
            >
            <input
              type="text"
              id="admin-location"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="Jakarta, Indonesia"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Instagram Handle</label
            >
            <input
              type="text"
              id="admin-instagram"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="@tokoku"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-primary mb-2"
              >Facebook Handle</label
            >
            <input
              type="text"
              id="admin-facebook"
              class="w-full px-4 py-3 rounded-lg border-2 border-color bg-transparent text-primary"
              value="TokoKu Official"
            />
          </div>
          <button
            type="submit"
            class="btn-primary w-full py-3 rounded-lg font-bold"
          >
            Simpan Perubahan
          </button>
        </form>
      </div>
    </div>
    <!-- Footer -->
    <footer class="nav-bar border-t border-color py-8 mt-20">
      <div class="container mx-auto px-6 text-center">
        <p class="text-secondary text-sm">
          ¬© 2024 <span id="footer-store-name">TokoKu</span>. All rights
          reserved.
        </p>
      </div>
    </footer>
    <script>
      // Product Data (Lo bisa edit manual di sini)
      const products = [
        {
          id: 1,
          name: "Tas Kulit Premium",
          price: 250000,
          description:
            "Tas kulit asli berkualitas tinggi dengan desain elegan. Cocok untuk acara formal maupun casual. Dilengkapi dengan beberapa kompartemen untuk menyimpan barang-barang penting Anda. Material kulit premium yang tahan lama dan mudah dirawat.",
          emoji: "üëú",
          featured: true,
        },
        {
          id: 2,
          name: "Sepatu Sneakers",
          price: 350000,
          description:
            "Sepatu sneakers stylish dan nyaman untuk aktivitas sehari-hari. Desain modern dengan bahan breathable yang membuat kaki tetap nyaman sepanjang hari. Sol empuk memberikan kenyamanan maksimal saat berjalan.",
          emoji: "üëü",
          featured: true,
        },
        {
          id: 3,
          name: "Jam Tangan Elegant",
          price: 450000,
          description:
            "Jam tangan dengan desain minimalis dan elegant. Tali stainless steel berkualitas tinggi, tahan air hingga 50 meter. Cocok untuk pria maupun wanita. Movement Jepang yang akurat dan tahan lama.",
          emoji: "‚åö",
          featured: true,
        },
        {
          id: 4,
          name: "Dompet Pria Kulit",
          price: 150000,
          description:
            "Dompet kulit asli dengan desain slim dan praktis. Terdapat banyak slot untuk kartu dan uang. Material kulit premium yang awet dan berkelas. Ukuran pas untuk disimpan di saku celana.",
          emoji: "üëõ",
          featured: false,
        },
        {
          id: 5,
          name: "Kacamata Hitam",
          price: 200000,
          description:
            "Kacamata hitam dengan frame berkualitas dan lensa UV protection. Melindungi mata dari sinar matahari berbahaya. Desain modern dan stylish cocok untuk berbagai bentuk wajah.",
          emoji: "üï∂Ô∏è",
          featured: false,
        },
        {
          id: 6,
          name: "Topi Baseball",
          price: 80000,
          description:
            "Topi baseball casual dengan bahan katun berkualitas. Nyaman dipakai seharian, cocok untuk melindungi dari panas matahari. Desain simple dan timeless.",
          emoji: "üß¢",
          featured: false,
        },
        {
          id: 7,
          name: "Kalung Fashion",
          price: 120000,
          description:
            "Kalung fashion dengan desain trendy dan elegan. Material anti karat dan tidak menyebabkan alergi. Cocok untuk melengkapi outfit harian Anda.",
          emoji: "üìø",
          featured: false,
        },
        {
          id: 8,
          name: "Gelang Kulit",
          price: 90000,
          description:
            "Gelang kulit dengan desain maskulin dan stylish. Bahan kulit asli yang lentur dan nyaman di pergelangan tangan. Cocok untuk penampilan casual maupun semi formal.",
          emoji: "üìø",
          featured: false,
        },
      ];

      // State Management
      let currentTheme = "light";
      let currentProduct = null;
      let previousPage = "home";

      const defaultConfig = {
        background_color: "#ffffff",
        card_color: "#f9fafb",
        text_color: "#1f2937",
        accent_color: "#10b981",
        secondary_text_color: "#6b7280",
        font_family: "system-ui",
        font_size: 16,
        store_name: "TokoKu",
        whatsapp_number: "628123456789",
        promo_text: "Diskon 50% Untuk Semua Produk!",
        store_description:
          "Toko online terpercaya menyediakan berbagai produk berkualitas dengan harga terjangkau.",
        store_location: "Jakarta, Indonesia",
        instagram_handle: "@tokoku",
        facebook_handle: "TokoKu Official",
      };

      // Config from Elements SDK
      async function onConfigChange(config) {
        const storeName = config.store_name || defaultConfig.store_name;
        const whatsappNumber =
          config.whatsapp_number || defaultConfig.whatsapp_number;
        const promoText = config.promo_text || defaultConfig.promo_text;
        const storeDescription =
          config.store_description || defaultConfig.store_description;
        const storeLocation =
          config.store_location || defaultConfig.store_location;
        const instagramHandle =
          config.instagram_handle || defaultConfig.instagram_handle;
        const facebookHandle =
          config.facebook_handle || defaultConfig.facebook_handle;

        const backgroundColor =
          config.background_color || defaultConfig.background_color;
        const cardColor = config.card_color || defaultConfig.card_color;
        const textColor = config.text_color || defaultConfig.text_color;
        const accentColor = config.accent_color || defaultConfig.accent_color;
        const secondaryTextColor =
          config.secondary_text_color || defaultConfig.secondary_text_color;
        const customFont = config.font_family || defaultConfig.font_family;
        const baseSize = config.font_size || defaultConfig.font_size;
        const baseFontStack = "system-ui, -apple-system, sans-serif";

        document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

        // Update store info
        document.querySelectorAll('[id*="store-name"]').forEach((el) => {
          el.textContent = storeName;
        });
        document.getElementById("promo-banner-text").textContent = promoText;
        document.getElementById("contact-description").textContent =
          storeDescription;
        document.getElementById("contact-location").textContent = storeLocation;
        document.getElementById("display-instagram").textContent =
          instagramHandle;
        document.getElementById("display-facebook").textContent =
          facebookHandle;
        document.getElementById("display-whatsapp").textContent =
          formatPhoneDisplay(whatsappNumber);

        // Update links
        document.getElementById(
          "whatsapp-link"
        ).href = `https://wa.me/${whatsappNumber}`;
        document.getElementById(
          "instagram-link"
        ).href = `https://instagram.com/${instagramHandle.replace("@", "")}`;
        document.getElementById(
          "facebook-link"
        ).href = `https://facebook.com/${facebookHandle}`;

        // Update admin form
        document.getElementById("admin-store-name").value = storeName;
        document.getElementById("admin-whatsapp").value = whatsappNumber;
        document.getElementById("admin-promo").value = promoText;
        document.getElementById("admin-description").value = storeDescription;
        document.getElementById("admin-location").value = storeLocation;
        document.getElementById("admin-instagram").value = instagramHandle;
        document.getElementById("admin-facebook").value = facebookHandle;

        // Apply colors
        if (currentTheme === "light") {
          document.body.style.backgroundColor = backgroundColor;
          document.body.style.color = textColor;

          document.querySelectorAll(".nav-bar").forEach((el) => {
            el.style.backgroundColor = backgroundColor;
            el.style.borderColor = cardColor;
          });

          document.querySelectorAll(".card-bg").forEach((el) => {
            el.style.backgroundColor = cardColor;
          });

          document.querySelectorAll(".text-primary").forEach((el) => {
            el.style.color = textColor;
          });

          document.querySelectorAll(".text-secondary").forEach((el) => {
            el.style.color = secondaryTextColor;
          });

          document.querySelectorAll(".border-color").forEach((el) => {
            el.style.borderColor = cardColor;
          });
        }

        document.querySelectorAll(".btn-primary").forEach((el) => {
          el.style.backgroundColor = accentColor;
        });

        // Font sizes
        const h1Elements = document.querySelectorAll("h1");
        h1Elements.forEach((el) => (el.style.fontSize = `${baseSize * 2.5}px`));

        const h2Elements = document.querySelectorAll("h2");
        h2Elements.forEach((el) => (el.style.fontSize = `${baseSize * 2}px`));

        const h3Elements = document.querySelectorAll("h3");
        h3Elements.forEach((el) => (el.style.fontSize = `${baseSize * 1.5}px`));

        const pElements = document.querySelectorAll("p, .text-sm, .text-lg");
        pElements.forEach((el) => {
          if (el.classList.contains("text-sm")) {
            el.style.fontSize = `${baseSize * 0.875}px`;
          } else if (el.classList.contains("text-lg")) {
            el.style.fontSize = `${baseSize * 1.125}px`;
          } else {
            el.style.fontSize = `${baseSize}px`;
          }
        });
      }

      function mapToCapabilities(config) {
        return {
          recolorables: [
            {
              get: () =>
                config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
            },
            {
              get: () => config.card_color || defaultConfig.card_color,
              set: (value) => {
                config.card_color = value;
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ card_color: value });
                }
              },
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
            },
            {
              get: () => config.accent_color || defaultConfig.accent_color,
              set: (value) => {
                config.accent_color = value;
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ accent_color: value });
                }
              },
            },
            {
              get: () =>
                config.secondary_text_color ||
                defaultConfig.secondary_text_color,
              set: (value) => {
                config.secondary_text_color = value;
                if (window.elementSdk) {
                  window.elementSdk.setConfig({ secondary_text_color: value });
                }
              },
            },
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              if (window.elementSdk) {
                window.elementSdk.setConfig({ font_family: value });
              }
            },
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              if (window.elementSdk) {
                window.elementSdk.setConfig({ font_size: value });
              }
            },
          },
        };
      }

      function mapToEditPanelValues(config) {
        return new Map([
          ["store_name", config.store_name || defaultConfig.store_name],
          [
            "whatsapp_number",
            config.whatsapp_number || defaultConfig.whatsapp_number,
          ],
          ["promo_text", config.promo_text || defaultConfig.promo_text],
          [
            "store_description",
            config.store_description || defaultConfig.store_description,
          ],
          [
            "store_location",
            config.store_location || defaultConfig.store_location,
          ],
          [
            "instagram_handle",
            config.instagram_handle || defaultConfig.instagram_handle,
          ],
          [
            "facebook_handle",
            config.facebook_handle || defaultConfig.facebook_handle,
          ],
        ]);
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues,
        });
      }

      // Initialize
      function init() {
        loadProducts();
        loadAdminData();
      }

      // Format currency
      function formatCurrency(amount) {
        return new Intl.NumberFormat("id-ID", {
          style: "currency",
          currency: "IDR",
          minimumFractionDigits: 0,
        }).format(amount);
      }

      // Format phone display
      function formatPhoneDisplay(phone) {
        if (phone.startsWith("62")) {
          return (
            "+" +
            phone.slice(0, 2) +
            " " +
            phone.slice(2, 5) +
            "-" +
            phone.slice(5, 9) +
            "-" +
            phone.slice(9)
          );
        }
        return phone;
      }

      // Load products
      function loadProducts() {
        const featuredContainer = document.getElementById("featured-products");
        const allProductsContainer = document.getElementById("all-products");

        featuredContainer.innerHTML = "";
        allProductsContainer.innerHTML = "";

        products.forEach((product) => {
          const productCard = createProductCard(product);

          if (product.featured) {
            featuredContainer.innerHTML += productCard;
          }
          allProductsContainer.innerHTML += productCard;
        });
      }

      // Create product card
      function createProductCard(product) {
        return `
        <div class="product-card card-bg rounded-xl overflow-hidden" onclick="viewProduct(${
          product.id
        })">
          <div class="h-48 flex items-center justify-center text-6xl">
            ${product.emoji}
          </div>
          <div class="p-6">
            <h3 class="text-xl font-bold text-primary mb-2">${product.name}</h3>
            <p class="text-secondary text-sm mb-4 line-clamp-2">${product.description.substring(
              0,
              80
            )}...</p>
            <div class="flex justify-between items-center">
              <span class="text-xl font-bold text-green-600">${formatCurrency(
                product.price
              )}</span>
              <button class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">Lihat Detail</button>
            </div>
          </div>
        </div>
      `;
      }

      // Navigation
      function navigateTo(pageName) {
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });

        const targetPage = document.getElementById(pageName);
        if (targetPage) {
          targetPage.classList.add("active");
          previousPage = pageName;
          window.scrollTo(0, 0);
        }
      }

      function navigateBack() {
        navigateTo(previousPage);
      }

      // View product detail
      function viewProduct(productId) {
        const product = products.find((p) => p.id === productId);
        if (!product) return;

        currentProduct = product;

        document.getElementById(
          "detail-image"
        ).innerHTML = `<span class="text-9xl">${product.emoji}</span>`;
        document.getElementById("detail-name").textContent = product.name;
        document.getElementById("detail-price").textContent = formatCurrency(
          product.price
        );
        document.getElementById("detail-description").textContent =
          product.description;

        const currentPage = document.querySelector(".page.active").id;
        previousPage = currentPage;

        navigateTo("product-detail");
      }

      // Order via WhatsApp
      function orderViaWhatsApp() {
        if (!currentProduct) return;

        const whatsappNumber =
          window.elementSdk?.config?.whatsapp_number ||
          defaultConfig.whatsapp_number;
        const storeName =
          window.elementSdk?.config?.store_name || defaultConfig.store_name;

        const message =
          `Halo ${storeName}, saya tertarik dengan produk:\n\n` +
          `Nama: ${currentProduct.name}\n` +
          `Harga: ${formatCurrency(currentProduct.price)}\n\n` +
          `Apakah produk ini masih tersedia?`;

        const encodedMessage = encodeURIComponent(message);
        const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

        window.open(whatsappUrl, "_blank", "noopener noreferrer");
      }

      // Theme toggle
      function toggleTheme() {
        const body = document.body;
        const themeIcon = document.getElementById("theme-icon");

        if (currentTheme === "light") {
          body.classList.remove("light");
          body.classList.add("dark");
          themeIcon.textContent = "‚òÄÔ∏è";
          currentTheme = "dark";
          applyDarkTheme();
        } else {
          body.classList.remove("dark");
          body.classList.add("light");
          themeIcon.textContent = "üåô";
          currentTheme = "light";
          applyLightTheme();
        }

        localStorage.setItem("theme", currentTheme);
      }

      // Apply dark theme colors
      function applyDarkTheme() {
        document.body.style.backgroundColor = "#111827";
        document.body.style.color = "#f9fafb";

        document.querySelectorAll(".nav-bar").forEach((el) => {
          el.style.backgroundColor = "#1f2937";
          el.style.borderColor = "#374151";
        });

        document.querySelectorAll(".card-bg").forEach((el) => {
          el.style.backgroundColor = "#1f2937";
        });

        document.querySelectorAll(".text-primary").forEach((el) => {
          el.style.color = "#f9fafb";
        });

        document.querySelectorAll(".text-secondary").forEach((el) => {
          el.style.color = "#9ca3af";
        });

        document.querySelectorAll(".border-color").forEach((el) => {
          el.style.borderColor = "#374151";
        });

        document.querySelectorAll("input, textarea").forEach((el) => {
          el.style.backgroundColor = "#1f2937";
          el.style.color = "#f9fafb";
          el.style.borderColor = "#374151";
        });

        document
          .querySelectorAll(".product-card h3, #detail-name")
          .forEach((el) => {
            el.style.color = "#f9fafb";
          });

        document
          .querySelectorAll(".product-card p:not(.text-green-600)")
          .forEach((el) => {
            el.style.color = "#9ca3af";
          });
      }

      // Apply light theme colors
      function applyLightTheme() {
        const config = window.elementSdk?.config || defaultConfig;
        const backgroundColor =
          config.background_color || defaultConfig.background_color;
        const cardColor = config.card_color || defaultConfig.card_color;
        const textColor = config.text_color || defaultConfig.text_color;
        const secondaryTextColor =
          config.secondary_text_color || defaultConfig.secondary_text_color;

        document.body.style.backgroundColor = backgroundColor;
        document.body.style.color = textColor;

        document.querySelectorAll(".nav-bar").forEach((el) => {
          el.style.backgroundColor = backgroundColor;
          el.style.borderColor = "#e5e7eb";
        });

        document.querySelectorAll(".card-bg").forEach((el) => {
          el.style.backgroundColor = cardColor;
        });

        document.querySelectorAll(".text-primary").forEach((el) => {
          el.style.color = textColor;
        });

        document.querySelectorAll(".text-secondary").forEach((el) => {
          el.style.color = secondaryTextColor;
        });

        document.querySelectorAll(".border-color").forEach((el) => {
          el.style.borderColor = "#e5e7eb";
        });

        document.querySelectorAll("input, textarea").forEach((el) => {
          el.style.backgroundColor = "#ffffff";
          el.style.color = textColor;
          el.style.borderColor = "#e5e7eb";
        });

        document
          .querySelectorAll(".product-card h3, #detail-name")
          .forEach((el) => {
            el.style.color = textColor;
          });

        document
          .querySelectorAll(".product-card p:not(.text-green-600)")
          .forEach((el) => {
            el.style.color = secondaryTextColor;
          });
      }

      // Load theme from localStorage
      function loadTheme() {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "dark") {
          document.body.classList.remove("light");
          document.body.classList.add("dark");
          document.getElementById("theme-icon").textContent = "‚òÄÔ∏è";
          currentTheme = "dark";
          setTimeout(() => applyDarkTheme(), 100);
        } else {
          setTimeout(() => applyLightTheme(), 100);
        }
      }

      // Admin modal
      function toggleAdminModal() {
        const modal = document.getElementById("admin-modal");
        modal.classList.toggle("active");
      }

      // Load admin data
      function loadAdminData() {
        const savedData = localStorage.getItem("adminData");
        if (savedData) {
          const data = JSON.parse(savedData);

          if (window.elementSdk) {
            window.elementSdk.setConfig(data);
          }
        }
      }

      // Admin form submit
      document
        .getElementById("admin-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const adminData = {
            store_name: document.getElementById("admin-store-name").value,
            whatsapp_number: document.getElementById("admin-whatsapp").value,
            promo_text: document.getElementById("admin-promo").value,
            store_description:
              document.getElementById("admin-description").value,
            store_location: document.getElementById("admin-location").value,
            instagram_handle: document.getElementById("admin-instagram").value,
            facebook_handle: document.getElementById("admin-facebook").value,
          };

          localStorage.setItem("adminData", JSON.stringify(adminData));

          if (window.elementSdk) {
            window.elementSdk.setConfig(adminData);
          }

          toggleAdminModal();

          // Show success feedback
          const btn = e.target.querySelector('button[type="submit"]');
          const originalText = btn.textContent;
          btn.textContent = "‚úì Berhasil Disimpan!";
          btn.style.backgroundColor = "#10b981";

          setTimeout(() => {
            btn.textContent = originalText;
          }, 2000);
        });

      // Initialize on load
      loadTheme();
      init();
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'9a0bfac9a0c83d99',t:'MTc2MzUxNjIxOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
